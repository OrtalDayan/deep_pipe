import(
	"assets/core.config",
	"assets/data_source/cobrain/brats.config"
	"assets/dataset/brats.config",
	"assets/training/segm.config",
)
from dpipe.tf.utils import optimize as optimize_fn


# Batch iter
x_patch_sizes = [[25, 25, 25], [57, 57, 57]]
y_patch_size = [9, 9, 9]
nonzero_fraction = 0.5

# Training
n_epochs = 120
n_iters_per_batch = 100
batch_size = 64

lr_init = 0.1
lr_dec_mul = 0.5
patience = 5
rtol = 0.03
atol = 0.01

optimize = optimize_fn(
    #lazy
    tf_optimizer_name = "MomentumOptimizer",
    use_nesterov = True,
    momentum = 0.9
)