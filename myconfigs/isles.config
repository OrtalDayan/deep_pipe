import "shared.config"
from "/home/gleb/deep_pipe/config_examples" import (
	"assets/data_source/cobrain/isles15.config"
	"assets/dataset/isles15.config",
    "brats.base.config",
    "assets/batch_iter/patch_3d.config"
	"assets/model/deepmedic_els.config"
	"assets/problem/segm.tf.config"
)
# from "/nmnt/media/home/gleb/deep_pipe/config_examples" import (
# 	"assets/data_source/iitp/brats.config"
# 	"assets/dataset/brats.config",
#     "brats.base.config",
#     "assets/batch_iter/patch_3d.config"
# 	"assets/model/deepmedic_els.config"
# 	"assets/problem/segm.tf.config"
# )
from dpipe.split.cv_111 import cv_111_truncated
from dpipe.split.cv_111 import group_cv_111_pure_011_truncated
from dpipe.tf.model import TFModel

makefile = "train_msegm_eval_light"
n_epochs = 2
batch_size = 24

lr_init = 0.001

split = group_cv_111_pure_011_truncated(
    n_splits = 5,
    val_size = 6,
    dataset = dataset,
    experiments_num=2
)

model = TFModel(
    model_core = model_core,
    logits2pred = logits2pred,
    logits2loss = logits2loss,
    optimize = optimize,
    surgery_transfer_path="/home/gleb/exp/oasis/3/experiment_0/model"
)

model_core = DeepMedicEls(
    with_dropout = True,
    dropout_rate = 0,
    downsampling_type = "sampling",
    n_chans_in = n_chans_in,
    n_chans_out = n_chans_out
)
